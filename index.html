<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>éŸ“èªå­¸ç¿’å°ç«™ v6.4 â€” ç²¾ç°¡ä½†å¤šæ¨£</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="manifest" href="./manifest.json" />
  <meta name="theme-color" content="#ff6680" />
  <style>
    :root { --pink:#ff6680; --sub:#ffe6eb; --bg:#fdfdfd; }
    body { font-family: "Microsoft JhengHei", system-ui, -apple-system, Segoe UI, Roboto, "Noto Sans CJK TC", sans-serif; margin:0; background:var(--bg); color:#222; }
    header { background:var(--pink); color:#fff; padding:16px; text-align:center; }
    nav { position:sticky; top:0; background:var(--sub); padding:10px; display:flex; gap:10px; justify-content:center; flex-wrap:wrap; z-index:10; }
    nav a { padding:8px 12px; font-weight:700; text-decoration:none; color:#333; background:#fff; border-radius:20px; border:1px solid #f1c2cc; }
    section { padding:16px; max-width:1100px; margin:0 auto; }
    h2 { color:var(--pink); margin:8px 0 12px; }
    .grid { display:grid; grid-template-columns:repeat(auto-fill,minmax(64px,1fr)); gap:10px; }
    .card { background:#fff; border:1px solid #f2d5dc; border-radius:10px; padding:10px; text-align:center; cursor:pointer; }
    .k{ font-size:26px; font-weight:900; }
    .small { font-size:12px; color:#666; margin-top:6px; }
    .box { background:#fff; border:1px solid #f2d5dc; border-radius:12px; padding:12px; margin:10px 0; }
    .row { display:flex; align-items:center; gap:10px; flex-wrap:wrap; }
    .chip { display:inline-block; padding:6px 10px; border-radius:999px; border:1px solid #e8b9c4; margin:4px; cursor:pointer; background:#fff; }
    .chip.active { background:var(--pink); color:#fff; border-color:var(--pink); }
    .btn { border:0; background:var(--pink); color:#fff; padding:8px 12px; border-radius:8px; font-weight:700; cursor:pointer; }
    .btn.outline { background:#fff; color:var(--pink); border:2px solid var(--pink); }
    .btn.ghost { background:#fff; color:#333; border:1px solid #ddd; }
    .search { width:100%; padding:10px 12px; border-radius:8px; border:1px solid #e8b9c4; }
    .dialogue { display:grid; grid-template-columns:1fr auto; gap:8px; align-items:center; border-bottom:1px dashed #f0c5cf; padding:10px 0; }
    .ko { font-weight:800; font-size:18px; }
    .zh { color:#444; font-size:14px; }
    .right { display:flex; gap:8px; align-items:center; }
    .fav { font-size:20px; cursor:pointer; }
    .numgrid { display:grid; grid-template-columns:repeat(auto-fill,minmax(90px,1fr)); gap:10px; }
    .numcard { background:#fff; border:1px solid #e7d6db; border-radius:10px; padding:10px; text-align:center; cursor:pointer; }
    footer { text-align:center; padding:14px; background:var(--pink); color:#fff; margin-top:20px; }
  </style>
</head>
<body>
  <header>
    <h1>éŸ“èªå­¸ç¿’å°ç«™ v6.4</h1>
    <p>ç²¾ç°¡ä½†å¤šæ¨£ï¼šä¸»é¡Œå°ˆå±¬å•ç­” + ç¥è³€ç”¨èªï¼›ä¿ç•™ 40éŸ³ï¼æ•¸å­—é‡è©ï¼æ”¶è—ï¼è‡ªè¨‚ï¼æ¸¬é©—</p>
  </header>

  <nav>
    <a href="#voice">èªéŸ³è¨­å®š</a>
    <a href="#alphabet">40 éŸ³</a>
    <a href="#numbers">æ•¸å­—/é‡è©</a>
    <a href="#dialogues">ä¸»é¡Œå°è©±</a>
    <a href="#custom">è‡ªè¨‚ä¸­æ–‡â†’éŸ“æ–‡</a>
    <a href="#quiz">æ¸¬é©—éŠæˆ²</a>
  </nav>

  <section id="voice" class="box">
    <h2>èªéŸ³è¨­å®šï¼ˆè¨˜ä½ä½ çš„é¸æ“‡ï¼‰</h2>
    <div class="row">
      <label>é¸æ“‡èªéŸ³ï¼š</label><select id="voiceSelect"></select>
      <label>é€Ÿåº¦</label><input id="rate" type="range" min="0.6" max="1.4" step="0.05" value="1">
      <label>éŸ³èª¿</label><input id="pitch" type="range" min="0.6" max="1.4" step="0.05" value="1">
      <button class="btn" id="testBtn">â–¶ æ¸¬è©¦ï¼šì•ˆë…•í•˜ì„¸ìš”</button>
      <div class="small">è‹¥æ¸…å–®æ²’æœ‰éŸ“æ–‡èªéŸ³ï¼Œè«‹åˆ°ç³»çµ±ä¸‹è¼‰éŸ“æ–‡èªéŸ³åŒ…ã€‚</div>
    </div>
  </section>

  <section id="alphabet">
    <h2>éŸ“æ–‡ 40 éŸ³</h2>
    <details open class="box">
      <summary>æ¯éŸ³ï¼ˆ21ï¼‰</summary>
      <div id="vowels" class="grid"></div>
    </details>
    <details open class="box">
      <summary>å­éŸ³ï¼ˆ19ï¼‰</summary>
      <div id="consonants" class="grid"></div>
    </details>
  </section>

  <section id="numbers" class="box">
    <h2>æ•¸å­—ï¼‹é‡è©ç·´ç¿’</h2>
    <div class="row">
      <label>æ•¸å­—ï¼ˆ1~10ï¼‰ï¼š</label><input id="qtyNum" type="number" min="1" max="10" value="1" style="width:80px;">
      <label>é‡è©ï¼š</label><select id="qtyCounter"></select>
      <button class="btn" id="qtySpeak">â–¶ æœ—è®€</button>
      <div id="qtyOut" class="small"></div>
    </div>
    <h3>å¸¸ç”¨æ•¸è©å¡</h3>
    <div id="numGrid" class="numgrid"></div>
  </section>

  <section id="dialogues">
    <h2>ä¸»é¡Œå°è©±ï¼ˆç²¾é¸ï¼Œä¸å¼·æ±‚æ•¸é‡ï¼‰</h2>
    <div class="box">
      <div class="row">
        <input id="q" class="search" placeholder="æœå°‹ä¸»é¡Œ/éŸ“æ–‡/ä¸­æ–‡ï¼ˆä¾‹ï¼šç¥è³€ï¼ê°€ê²©ï¼ì§€í•˜ì² ï¼‰" />
        <button class="btn outline" onclick="resetFilter()">æ¸…é™¤æœå°‹</button>
        <button class="btn ghost" id="showFav">åªçœ‹æ”¶è—</button>
      </div>
      <div id="tagBar" style="margin-top:8px;"></div>
    </div>
    <div id="dialogueList"></div>
  </section>

  <section id="custom" class="box">
    <h2>è‡ªè¨‚ä¸­æ–‡ â†’ éŸ“æ–‡ï¼ˆç™¼éŸ³ç·´ç¿’ï¼‰</h2>
    <div class="row">
      <input id="cnInput" class="search" placeholder="è¼¸å…¥ä¸­æ–‡å¥å­ï¼ˆä¾‹ï¼šæ­å–œå‡è·ï¼‰" style="flex:1;">
      <button class="btn" id="cnSuggest">ç”¢ç”Ÿå»ºè­°éŸ“æ–‡</button>
    </div>
    <div class="row" style="margin-top:8px;">
      <input id="koInput" class="search" placeholder="éŸ“æ–‡çµæœï¼ˆå¯è‡ªè¡Œä¿®æ”¹ï¼‰" style="flex:1;">
      <button class="btn" id="koSpeak">â–¶ æœ—è®€éŸ“æ–‡</button>
      <button class="btn outline" id="saveCustom">åŠ å…¥åˆ°ã€æˆ‘çš„å°è©±ã€</button>
    </div>
    <div class="small">èªªæ˜ï¼šæ­¤è™•çš„ä¸­æ–‡â†’éŸ“æ–‡ç‚ºç°¡æ˜“å­—å…¸å»ºè­°ï¼Œè«‹è‡ªè¡Œä¿®æ­£ç‚ºæœ€è‡ªç„¶çš„è¡¨é”ã€‚</div>
    <div id="myList" style="margin-top:10px;"></div>
  </section>

  <section id="quiz" class="box">
    <h2>æ¸¬é©—éŠæˆ²ï¼šé…å°éŸ“æ–‡èˆ‡ä¸­æ–‡</h2>
    <div class="row">
      <button class="btn" id="startQuiz">é–‹å§‹æ¸¬é©—</button>
      <div id="quizScore" class="small"></div>
    </div>
    <div id="quizArea" style="margin-top:10px;"></div>
  </section>

  <footer>Â© 2025 éŸ“èªå­¸ç¿’å°ç«™ â€” v6.4ï¼ˆPWA å¯é›¢ç·šï¼‰</footer>

  <script>
    const DATA_VOWELS = [{"j": "ã…", "ex": "ì•„", "note": "a"}, {"j": "ã…", "ex": "ì• ", "note": "ae"}, {"j": "ã…‘", "ex": "ì•¼", "note": "ya"}, {"j": "ã…’", "ex": "ì–˜", "note": "yae"}, {"j": "ã…“", "ex": "ì–´", "note": "eo"}, {"j": "ã…”", "ex": "ì—", "note": "e"}, {"j": "ã…•", "ex": "ì—¬", "note": "yeo"}, {"j": "ã…–", "ex": "ì˜ˆ", "note": "ye"}, {"j": "ã…—", "ex": "ì˜¤", "note": "o"}, {"j": "ã…˜", "ex": "ì™€", "note": "wa"}, {"j": "ã…™", "ex": "ì™œ", "note": "wae"}, {"j": "ã…š", "ex": "ì™¸", "note": "oe"}, {"j": "ã…›", "ex": "ìš”", "note": "yo"}, {"j": "ã…œ", "ex": "ìš°", "note": "u"}, {"j": "ã…", "ex": "ì›Œ", "note": "wo"}, {"j": "ã…", "ex": "ì›¨", "note": "we"}, {"j": "ã…Ÿ", "ex": "ìœ„", "note": "wi"}, {"j": "ã… ", "ex": "ìœ ", "note": "yu"}, {"j": "ã…¡", "ex": "ìœ¼", "note": "eu"}, {"j": "ã…¢", "ex": "ì˜", "note": "ui"}, {"j": "ã…£", "ex": "ì´", "note": "i"}];
    const DATA_CONSONANTS = [{"j": "ã„±", "ex": "ê°€", "note": "g/k"}, {"j": "ã„²", "ex": "ê¹Œ", "note": "kk"}, {"j": "ã„´", "ex": "ë‚˜", "note": "n"}, {"j": "ã„·", "ex": "ë‹¤", "note": "d/t"}, {"j": "ã„¸", "ex": "ë”°", "note": "tt"}, {"j": "ã„¹", "ex": "ë¼", "note": "r/l"}, {"j": "ã…", "ex": "ë§ˆ", "note": "m"}, {"j": "ã…‚", "ex": "ë°”", "note": "b/p"}, {"j": "ã…ƒ", "ex": "ë¹ ", "note": "pp"}, {"j": "ã……", "ex": "ì‚¬", "note": "s"}, {"j": "ã…†", "ex": "ì‹¸", "note": "ss"}, {"j": "ã…‡", "ex": "ì•„", "note": "âˆ…/ng"}, {"j": "ã…ˆ", "ex": "ì", "note": "j"}, {"j": "ã…‰", "ex": "ì§œ", "note": "jj"}, {"j": "ã…Š", "ex": "ì°¨", "note": "ch"}, {"j": "ã…‹", "ex": "ì¹´", "note": "k"}, {"j": "ã…Œ", "ex": "íƒ€", "note": "t"}, {"j": "ã…", "ex": "íŒŒ", "note": "p"}, {"j": "ã…", "ex": "í•˜", "note": "h"}];
    const DATA_COUNTERS = [{"counter": "ê°œ", "note": "ä¸€èˆ¬ç‰©å“ï¼ˆå€‹ï¼‰", "system": "native"}, {"counter": "ëª…", "note": "äººï¼ˆåï¼‰", "system": "native"}, {"counter": "ë§ˆë¦¬", "note": "å‹•ç‰©ï¼ˆéš»ï¼‰", "system": "native"}, {"counter": "ì”", "note": "æ¯ï¼ˆé£²æ–™ï¼‰", "system": "native"}, {"counter": "ë³‘", "note": "ç“¶", "system": "native"}, {"counter": "ê¶Œ", "note": "æœ¬ï¼ˆæ›¸ï¼‰", "system": "native"}, {"counter": "ì¥", "note": "å¼µï¼ˆç¥¨/ç´™ï¼‰", "system": "native"}, {"counter": "ëŒ€", "note": "å°ï¼ˆè»Š/æ©Ÿå™¨ï¼‰", "system": "native"}, {"counter": "ì‹œê°„", "note": "å°æ™‚ï¼ˆæŒçºŒï¼‰", "system": "native"}, {"counter": "ì‚´", "note": "æ­²", "system": "native"}, {"counter": "ì‹œ", "note": "é»ï¼ˆæ™‚ï¼‰", "system": "native"}, {"counter": "ë²ˆ", "note": "æ¬¡æ•¸", "system": "sino"}, {"counter": "ì¸µ", "note": "æ¨“å±¤", "system": "sino"}, {"counter": "ì›”", "note": "æœˆä»½", "system": "sino"}, {"counter": "ì¼", "note": "æ—¥æœŸ", "system": "sino"}, {"counter": "ì›", "note": "é‡‘é¡ï¼ˆéŸ“å…ƒï¼‰", "system": "sino"}];
    const DATA_NATIVE = {"1": "í•˜ë‚˜", "2": "ë‘˜", "3": "ì…‹", "4": "ë„·", "5": "ë‹¤ì„¯", "6": "ì—¬ì„¯", "7": "ì¼ê³±", "8": "ì—¬ëŸ", "9": "ì•„í™‰", "10": "ì—´"};
    const DATA_SINO = {"1": "ì¼", "2": "ì´", "3": "ì‚¼", "4": "ì‚¬", "5": "ì˜¤", "6": "ìœ¡", "7": "ì¹ ", "8": "íŒ”", "9": "êµ¬", "10": "ì‹­"};
    const DATA_CN2KO = {"ä½ å¥½": "ì•ˆë…•í•˜ì„¸ìš”", "è¬è¬": "ê°ì‚¬í•©ë‹ˆë‹¤", "å°ä¸èµ·": "ì£„ì†¡í•©ë‹ˆë‹¤", "è«‹çµ¦æˆ‘": "ì£¼ì„¸ìš”", "å¤šå°‘éŒ¢": "ì–¼ë§ˆì˜ˆìš”?", "å¯ä»¥å¹«æˆ‘": "ë„ì™€ ì£¼ì„¸ìš”", "åœ¨å“ªè£¡": "ì–´ë””ì˜ˆìš”?", "å»æ‰€": "í™”ì¥ì‹¤", "æˆ‘è¦é»é¤": "ì£¼ë¬¸í• ê²Œìš”", "ä¸è¦è¾£": "ì•ˆ ë§µê²Œ í•´ ì£¼ì„¸ìš”", "æˆ‘è¦çµå¸³": "ê³„ì‚°í•´ ì£¼ì„¸ìš”", "æœ‰æ²’æœ‰": "ìˆì–´ìš”?", "å¯ä»¥å—": "ê°€ëŠ¥í•´ìš”?", "ä¸å¥½æ„æ€": "ì‹¤ë¡€í•©ë‹ˆë‹¤", "å†è¦‹": "ì•ˆë…•íˆ ê°€ì„¸ìš”"};
    const DATA_DIALOGUES = [{"tag": "é£¾å“è²·è³£", "ko": ["ì´ê±´ ì‹¤ë²„ì˜ˆìš” ì•„ë‹ˆë©´ ë„ê¸ˆì´ì—ìš”?", "ì´ê±´ ì‹¤ë²„ì˜ˆìš”.", "ì´ê±´ ë„ê¸ˆì´ì—ìš”.", "ì´ê±´ ìŠ¤í…Œì¸ë¦¬ìŠ¤ì˜ˆìš”."], "zh": ["é€™æ˜¯ç´”éŠ€é‚„æ˜¯é›»éï¼Ÿ", "é€™æ˜¯ç´”éŠ€ã€‚", "é€™æ˜¯é›»éã€‚", "é€™æ˜¯ä¸é½é‹¼ã€‚"]}, {"tag": "é£¾å“è²·è³£", "ko": ["í• ì¸ ë˜ë‚˜ìš”?", "ë„¤, 10% í• ì¸ë¼ìš”.", "ì„¸ì¼ ìƒí’ˆì€ í• ì¸ ì•ˆ ë¼ìš”."], "zh": ["æœ‰æŠ˜æ‰£å—ï¼Ÿ", "æ˜¯çš„ï¼Œå¯æ‰“ä¹æŠ˜ã€‚", "ç‰¹åƒ¹å“ç„¡æ³•å†æŠ˜æ‰£ã€‚"]}, {"tag": "é£¾å“è²·è³£", "ko": ["ê°ì¸ ì„œë¹„ìŠ¤ ê°€ëŠ¥í•´ìš”?", "ë„¤, ë¬´ë£Œë¡œ ê°€ëŠ¥í•©ë‹ˆë‹¤.", "ê°€ëŠ¥í•˜ì§€ë§Œ ì¶”ê°€ ìš”ê¸ˆì´ ìˆì–´ìš”."], "zh": ["å¯ä»¥åˆ»å­—å—ï¼Ÿ", "å¯ä»¥ï¼Œå…è²»ã€‚", "å¯ä»¥ï¼Œä½†éœ€åŠ åƒ¹ã€‚"]}, {"tag": "é£¾å“è²·è³£", "ko": ["ì‚¬ì´ì¦ˆ ì¡°ì ˆ ë˜ë‚˜ìš”?", "ê°€ëŠ¥í•©ë‹ˆë‹¤. í•˜ë£¨ ì •ë„ ì†Œìš”ë¼ìš”.", "ì£„ì†¡í•˜ì§€ë§Œ ì´ ì œí’ˆì€ ì¡°ì ˆì´ ì–´ë ¤ì›Œìš”."], "zh": ["å¯ä»¥èª¿æ•´å°ºå¯¸å—ï¼Ÿ", "å¯ä»¥ï¼Œå¤§ç´„éœ€è¦ä¸€å¤©ã€‚", "æŠ±æ­‰ï¼Œé€™æ¬¾ç„¡æ³•èª¿æ•´ã€‚"]}, {"tag": "é£¾å“è²·è³£", "ko": ["ë³´ì¦ì„œ ìˆì–´ìš”?", "ë„¤, ë³´ì¦ì„œ ë“œë ¤ìš”.", "ë³´ì¦ì„œëŠ” ì´ë©”ì¼ë¡œ ë³´ë‚´ ë“œë ¤ìš”."], "zh": ["æœ‰ä¿å›ºæ›¸å—ï¼Ÿ", "æœ‰ï¼Œæœƒé™„ä¸Šä¿å›ºæ›¸ã€‚", "ä¿å›ºæ›¸ä»¥é›»å­éƒµä»¶å¯„é€ã€‚"]}, {"tag": "é£¾å“è²·è³£", "ko": ["êµí™˜í•  ìˆ˜ ìˆë‚˜ìš”?", "7ì¼ ì´ë‚´ ê°€ëŠ¥í•´ìš”.", "ì‚¬ìš© í”ì ì´ ìˆìœ¼ë©´ ì–´ë µìŠµë‹ˆë‹¤."], "zh": ["å¯ä»¥æ›è²¨å—ï¼Ÿ", "ä¸ƒæ—¥å…§å¯ä»¥ã€‚", "è‹¥æœ‰ä½¿ç”¨ç—•è·¡å°±ä¸è¡Œã€‚"]}, {"tag": "è³¼ç‰©", "ko": ["ì´ ì˜· ì…ì–´ ë´ë„ ë¼ìš”?", "ë„¤, í”¼íŒ…ë£¸ì€ ì €ìª½ì´ì—ìš”.", "ì£„ì†¡í•˜ì§€ë§Œ ì„¸ì¼ ìƒí’ˆì€ ì‹œì°©ì´ ë¶ˆê°€í•´ìš”."], "zh": ["é€™ä»¶è¡£æœå¯ä»¥è©¦ç©¿å—ï¼Ÿ", "å¯ä»¥ï¼Œè©¦è¡£é–“åœ¨é‚£é‚Šã€‚", "æŠ±æ­‰ï¼Œç‰¹åƒ¹å•†å“ä¸èƒ½è©¦ç©¿ã€‚"]}, {"tag": "è³¼ç‰©", "ko": ["ë‹¤ë¥¸ ìƒ‰ ìˆì–´ìš”?", "ë„¤, ê²€ì •ìƒ‰ë„ ìˆì–´ìš”.", "ì§€ê¸ˆì€ í°ìƒ‰ë§Œ ìˆì–´ìš”."], "zh": ["æœ‰å…¶ä»–é¡è‰²å—ï¼Ÿ", "æœ‰ï¼Œé‚„æœ‰é»‘è‰²ã€‚", "ç¾åœ¨åªæœ‰ç™½è‰²ã€‚"]}, {"tag": "äº¤é€š", "ko": ["ê³µí•­ê¹Œì§€ íƒì‹œ ì–¼ë§ˆì˜ˆìš”?", "ë³´í†µ 4ë§Œ ì› ì •ë„ì˜ˆìš”.", "êµí†µ ìƒí™©ì— ë”°ë¼ ë‹¬ë¼ìš”."], "zh": ["åˆ°æ©Ÿå ´è¨ˆç¨‹è»Šå¤šå°‘éŒ¢ï¼Ÿ", "é€šå¸¸ç´„å››è¬éŸ“å…ƒã€‚", "è¦çœ‹äº¤é€šç‹€æ³ã€‚"]}, {"tag": "äº¤é€š", "ko": ["ì´ ë²„ìŠ¤ ì–´ë””ì„œ íƒ€ìš”?", "ì €ê¸° ì •ë¥˜ì¥ì—ì„œ íƒ€ì‹œë©´ ë¼ìš”.", "ì´ ë…¸ì„ ì€ ì €ë… 8ì‹œê¹Œì§€ë§Œ ìš´í–‰í•´ìš”."], "zh": ["é€™ç­å…¬è»Šåœ¨å“ªè£¡æ­ï¼Ÿ", "åœ¨é‚£é‚Šçš„ç«™ç‰Œæ­ã€‚", "é€™è·¯ç·šåªåˆ°æ™šä¸Šå…«é»ã€‚"]}, {"tag": "äº¤é€š", "ko": ["í™˜ìŠ¹ì€ ì–´ë””ì„œ í•´ìš”?", "ë‹¤ìŒ ì—­ì—ì„œ ë‚´ë¦¬ì‹œë©´ í™˜ìŠ¹ì´ì—ìš”.", "í‘œì§€íŒ ë”°ë¼ê°€ì‹œë©´ ë¼ìš”."], "zh": ["åœ¨å“ªè£¡è½‰ä¹˜ï¼Ÿ", "ä¸‹ä¸€ç«™ä¸‹è»Šè½‰ä¹˜ã€‚", "è·Ÿè‘—æŒ‡ç¤ºç‰Œèµ°å°±è¡Œã€‚"]}, {"tag": "äº¤é€š", "ko": ["í‹°ë¨¸ë‹ˆ ì¶©ì „ì€ ì–´ë””ì„œ í•´ìš”?", "í¸ì˜ì ì—ì„œ ì¶©ì „í•  ìˆ˜ ìˆì–´ìš”.", "ì§€í•˜ì²  ì—­ë¬´ì‹¤ì—ì„œë„ ê°€ëŠ¥í•´ìš”."], "zh": ["T-moneyåœ¨å“ªè£¡åŠ å€¼ï¼Ÿ", "åœ¨ä¾¿åˆ©å•†åº—å¯ä»¥åŠ å€¼ã€‚", "åœ¨åœ°éµç«™å‹™å®¤ä¹Ÿå¯ä»¥ã€‚"]}, {"tag": "ä½å®¿", "ko": ["ì²´í¬ì¸ ëª‡ ì‹œë¶€í„°ì˜ˆìš”?", "ì˜¤í›„ 3ì‹œë¶€í„° ì²´í¬ì¸ ê°€ëŠ¥í•´ìš”.", "ì¡°ê¸° ì²´í¬ì¸ì€ ì¶”ê°€ ìš”ê¸ˆì´ ìˆì–´ìš”."], "zh": ["å¹¾é»å¯ä»¥å…¥ä½ï¼Ÿ", "ä¸‹åˆä¸‰é»èµ·å¯å…¥ä½ã€‚", "ææ—©å…¥ä½éœ€åŠ åƒ¹ã€‚"]}, {"tag": "ä½å®¿", "ko": ["ë ˆì´íŠ¸ ì²´í¬ì•„ì›ƒ ê°€ëŠ¥í•´ìš”?", "ë„¤, ì˜¤í›„ 1ì‹œê¹Œì§€ ê°€ëŠ¥í•´ìš”.", "ì£„ì†¡í•˜ì§€ë§Œ ì˜¤ëŠ˜ì€ ì–´ë µìŠµë‹ˆë‹¤."], "zh": ["å¯ä»¥æ™šé€€æˆ¿å—ï¼Ÿ", "å¯ä»¥ï¼Œæœ€æ™šåˆ°ä¸‹åˆä¸€é»ã€‚", "æŠ±æ­‰ï¼Œä»Šå¤©ä¸è¡Œã€‚"]}, {"tag": "ä½å®¿", "ko": ["ì¡°ì‹ì€ ëª‡ ì‹œë¶€í„°ì˜ˆìš”?", "7ì‹œë¶€í„° 10ì‹œê¹Œì§€ì˜ˆìš”.", "ë ˆìŠ¤í† ë‘ 1ì¸µì—ì„œ ë“œì‹¤ ìˆ˜ ìˆì–´ìš”."], "zh": ["æ—©é¤å¹¾é»é–‹å§‹ï¼Ÿ", "ä¸ƒé»åˆ°åé»ã€‚", "åœ¨ä¸€æ¨“é¤å»³ç”¨é¤ã€‚"]}, {"tag": "ä½å®¿", "ko": ["ì§ ë³´ê´€ ê°€ëŠ¥í•´ìš”?", "ë„¤, ì²´í¬ì¸ ì „í›„ ë³´ê´€í•´ ë“œë ¤ìš”.", "ê·€ì¤‘í’ˆì€ í”„ëŸ°íŠ¸ì— ë§¡ê²¨ ì£¼ì„¸ìš”."], "zh": ["å¯ä»¥å¯„æ”¾è¡Œæå—ï¼Ÿ", "å¯ä»¥ï¼Œå…¥ä½å‰å¾Œéƒ½èƒ½å¯„æ”¾ã€‚", "è²´é‡ç‰©å“è«‹äº¤ç”±æ«ƒå°ä¿ç®¡ã€‚"]}, {"tag": "é¤å»³", "ko": ["ì¶”ì²œ ë©”ë‰´ê°€ ë­ì˜ˆìš”?", "ì˜¤ëŠ˜ì€ ë¶ˆê³ ê¸°ë¥¼ ì¶”ì²œí•©ë‹ˆë‹¤.", "ë¹„ë¹”ë°¥ì´ ì œì¼ ì¸ê¸°ê°€ ë§ì•„ìš”."], "zh": ["æœ‰æ¨è–¦çš„èœå—ï¼Ÿ", "ä»Šå¤©æ¨è–¦çƒ¤è‚‰ã€‚", "æ‹Œé£¯æœ€å—æ­¡è¿ã€‚"]}, {"tag": "é¤å»³", "ko": ["ëœ ë§µê²Œ í•´ ì£¼ì„¸ìš”.", "ë„¤, ê³ ì¶”ëŠ” ë¹¼ ë“œë¦´ê²Œìš”.", "ì–‘ë…ì„ ì¡°ê¸ˆë§Œ ë„£ì„ê²Œìš”."], "zh": ["è«‹åšä¸è¾£ä¸€é»ã€‚", "å¥½ï¼Œæˆ‘å»æ‰è¾£æ¤’ã€‚", "æˆ‘åªæ”¾ä¸€é»èª¿å‘³ã€‚"]}, {"tag": "é¤å»³", "ko": ["í¬ì¥ ë¼ìš”?", "ë„¤, í¬ì¥ ê°€ëŠ¥í•´ìš”.", "ì¡°ê¸ˆ ì‹œê°„ ê±¸ë ¤ìš”."], "zh": ["å¯ä»¥å¤–å¸¶å—ï¼Ÿ", "å¯ä»¥å¤–å¸¶ã€‚", "éœ€è¦ç­‰ä¸€ä¸‹ã€‚"]}, {"tag": "é¤å»³", "ko": ["ê³„ì‚°ì„œ ë¶€íƒí•´ìš”.", "ì ì‹œë§Œìš”, ë°”ë¡œ ê°€ì ¸ë‹¤ ë“œë¦´ê²Œìš”.", "ì¹´ìš´í„°ì—ì„œ ê²°ì œí•´ ì£¼ì„¸ìš”."], "zh": ["è«‹çµ¦æˆ‘å¸³å–®ã€‚", "è«‹ç¨ç­‰ï¼Œæˆ‘é¦¬ä¸Šæ‹¿ä¾†ã€‚", "è«‹åˆ°æ«ƒå°çµå¸³ã€‚"]}, {"tag": "å•è·¯", "ko": ["ì§€í•˜ì² ì—­ì´ ì–´ë””ì˜ˆìš”?", "ì €ê¸° ì‹ í˜¸ë“± ê±´ë„ˆí¸ì— ìˆì–´ìš”."], "zh": ["åœ°éµç«™åœ¨å“ªè£¡ï¼Ÿ", "åœ¨ç´…ç¶ ç‡ˆå°é¢ã€‚"]}, {"tag": "å•è·¯", "ko": ["ëª…ë™ê¹Œì§€ ì–´ë–»ê²Œ ê°€ìš”?", "2í˜¸ì„ ìœ¼ë¡œ ê°ˆì•„íƒ€ì„¸ìš”."], "zh": ["åˆ°æ˜æ´æ€éº¼å»ï¼Ÿ", "è«‹è½‰ä¹˜äºŒè™Ÿç·šã€‚"]}, {"tag": "ç¥è³€ç”¨èª", "ko": ["ì–´ë–»ê²Œ ì¶•í•˜ ì¸ì‚¬í•´ìš”?ï¼ˆç”Ÿæ—¥ï¼‰", "ìƒì¼ ì¶•í•˜í•´ìš”!", "ìƒì¼ ì¶•í•˜í•©ë‹ˆë‹¤!"], "zh": ["æ€éº¼èªªç”Ÿæ—¥ç¥è³€ï¼Ÿ", "ç”Ÿæ—¥å¿«æ¨‚ï¼", "ç¥ä½ ç”Ÿæ—¥å¿«æ¨‚ï¼ï¼ˆæ•¬èªï¼‰"]}, {"tag": "ç¥è³€ç”¨èª", "ko": ["ì–´ë–»ê²Œ ì¶•í•˜ ì¸ì‚¬í•´ìš”?ï¼ˆçµå©šï¼‰", "ê²°í˜¼ ì¶•í•˜í•´ìš”!", "í–‰ë³µí•˜ì„¸ìš”!"], "zh": ["æ€éº¼èªªçµå©šç¥è³€ï¼Ÿ", "æ­å–œçµå©šï¼", "ç¥ä½ å€‘å¹¸ç¦ï¼"]}, {"tag": "ç¥è³€ç”¨èª", "ko": ["ì–´ë–»ê²Œ ì¶•í•˜ ì¸ì‚¬í•´ìš”?ï¼ˆå‡è·ï¼‰", "ìŠ¹ì§„ ì¶•í•˜í•´ìš”!", "ì•ìœ¼ë¡œë„ ì˜ ë˜ê¸¸ ë°”ë„ê²Œìš”."], "zh": ["æ€éº¼èªªå‡è·ç¥è³€ï¼Ÿ", "æ­å–œå‡è·ï¼", "ç¥ä½ æœªä¾†é †åˆ©ã€‚"]}, {"tag": "ç¥è³€ç”¨èª", "ko": ["ì–´ë–»ê²Œ ì¶•í•˜ ì¸ì‚¬í•´ìš”?ï¼ˆæ–°å¹´ï¼‰", "ìƒˆí•´ ë³µ ë§ì´ ë°›ìœ¼ì„¸ìš”!"], "zh": ["æ€éº¼èªªæ–°å¹´ç¥è³€ï¼Ÿ", "æ–°å¹´å¿«æ¨‚ï¼Œæ­å–œç™¼è²¡ï¼"]}, {"tag": "ç¥è³€ç”¨èª", "ko": ["ì–´ë–»ê²Œ ì¶•í•˜ ì¸ì‚¬í•´ìš”?ï¼ˆå…¥å­¸/éŒ„å–ï¼‰", "í•©ê²© ì¶•í•˜í•´ìš”!", "ì…í•™ ì¶•í•˜í•´ìš”!"], "zh": ["æ€éº¼èªªå…¥å­¸/éŒ„å–ç¥è³€ï¼Ÿ", "æ­å–œéŒ„å–ï¼", "æ­å–œå…¥å­¸ï¼"]}, {"tag": "ç¥è³€ç”¨èª", "ko": ["ì–´ë–»ê²Œ ì¶•í•˜ ì¸ì‚¬í•´ìš”?ï¼ˆå–¬é·ï¼‰", "ì´ì‚¬ ì¶•í•˜í•´ìš”!", "ìƒˆ ì§‘ì—ì„œë„ í–‰ë³µí•˜ì„¸ìš”."], "zh": ["æ€éº¼èªªå–¬é·ä¹‹å–œï¼Ÿ", "æ­å–œæ¬æ–°å®¶ï¼", "ç¥ä½ åœ¨æ–°å®¶ä¹Ÿå¹¸ç¦ã€‚"]}];

    // ====== Persistence / Voice ======
    let VOICES=[];
    const save=(k,v)=>localStorage.setItem(k, JSON.stringify(v));
    const load=(k,d)=>{ try{const v=localStorage.getItem(k); return v? JSON.parse(v): d;}catch(e){return d;} };
    const saveStr=(k,v)=>localStorage.setItem(k,v);
    const loadStr=(k,d)=>{ const v=localStorage.getItem(k); return v===null? d : v; };

    function speak(text){
      const msg=new SpeechSynthesisUtterance(text);
      msg.rate=parseFloat(loadStr('rate','1')); msg.pitch=parseFloat(loadStr('pitch','1'));
      const pickName=loadStr('voiceName',''); const voices=speechSynthesis.getVoices();
      let voice=voices.find(v=>v.name===pickName)||voices.find(v=>(v.lang||'').toLowerCase().startsWith('ko'))||voices[0];
      if(voice) msg.voice=voice; if(!(voice&&(voice.lang||'').toLowerCase().startsWith('ko'))&&/[ê°€-í£]/.test(text)) msg.lang='ko-KR';
      speechSynthesis.cancel(); speechSynthesis.speak(msg);
    }
    function populateVoices(){
      VOICES = speechSynthesis.getVoices();
      const sel=document.getElementById('voiceSelect'); sel.innerHTML='';
      const sorted=VOICES.slice().sort((a,b)=>(a.lang||'').localeCompare(b.lang||''));
      sorted.forEach(v=>{ const o=document.createElement('option'); o.value=v.name; o.textContent=`${v.name} â€” ${v.lang}`; sel.appendChild(o); });
      const saved=loadStr('voiceName',''); if(saved && sorted.find(v=>v.name===saved)) sel.value=saved;
      else { const ko=sorted.find(v=>(v.lang||'').toLowerCase().startsWith('ko')); sel.value = ko? ko.name : (sorted[0]? sorted[0].name : ''); }
    }
    speechSynthesis.onvoiceschanged=populateVoices; populateVoices();
    document.getElementById('voiceSelect').addEventListener('change', e=> saveStr('voiceName', e.target.value));
    document.getElementById('rate').value = loadStr('rate','1'); document.getElementById('pitch').value = loadStr('pitch','1');
    document.getElementById('rate').addEventListener('input', e=> saveStr('rate', e.target.value));
    document.getElementById('pitch').addEventListener('input', e=> saveStr('pitch', e.target.value));
    document.getElementById('testBtn').addEventListener('click', ()=>speak('ì•ˆë…•í•˜ì„¸ìš”'));

    // 40éŸ³
    function renderJamo(list, el){ el.innerHTML=''; list.forEach(x=>{ const d=document.createElement('div'); d.className='card'; d.innerHTML=`<div class="k">${x.j}</div><div class="small">ä¾‹ï¼š${x.ex||''}</div><div class="small">${x.note||''}</div>`; d.onclick=()=>speak(x.ex||x.j); el.appendChild(d); }); }
    renderJamo(DATA_VOWELS, document.getElementById('vowels')); renderJamo(DATA_CONSONANTS, document.getElementById('consonants'));

    // æ•¸å­—ï¼‹é‡è©
    const counterSel=document.getElementById('qtyCounter');
    DATA_COUNTERS.forEach(c=>{ const o=document.createElement('option'); o.value=c.counter; o.textContent=`${c.counter} â€” ${c.note} (${c.system==='native'?'åŸç”Ÿæ•¸è©':'æ¼¢å­—æ•¸è©'})`; o.dataset.system=c.system; counterSel.appendChild(o); });
    function buildQty(){ const n=Math.max(1,Math.min(10,parseInt(document.getElementById('qtyNum').value||'1'))); const sel=counterSel.options[counterSel.selectedIndex]; const sys=sel.dataset.system; const num=(sys==='native'? DATA_NATIVE[n] : DATA_SINO[n]); const phrase = `${num} ${sel.value}`; document.getElementById('qtyOut').textContent = `â†’ éŸ“æ–‡è®€æ³•ï¼š${phrase}`; speak(phrase); }
    document.getElementById('qtySpeak').addEventListener('click', buildQty);
    const numGrid=document.getElementById('numGrid');
    [1,2,3,4,5,6,7,8,9,10].forEach(n=>{ const d=document.createElement('div'); d.className='numcard'; d.innerHTML=`<div class="k">${DATA_NATIVE[n]}</div><div class="small">åŸç”Ÿæ•¸è© ${n}</div>`; d.onclick=()=>speak(DATA_NATIVE[n]); numGrid.appendChild(d); });
    [1,2,3,4,5,6,7,8,9,10].forEach(n=>{ const d=document.createElement('div'); d.className='numcard'; d.innerHTML=`<div class="k">${DATA_SINO[n]}</div><div class="small">æ¼¢å­—æ•¸è© ${n}</div>`; d.onclick=()=>speak(DATA_SINO[n]); numGrid.appendChild(d); });

    // å°è©±ï¼šæ¨™ç±¤ï¼‹æœå°‹ï¼‹æ”¶è—
    const favSet = new Set(JSON.parse(localStorage.getItem('favs')||'[]'));
    const tagBar=document.getElementById('tagBar'); const allTags=Array.from(new Set(DATA_DIALOGUES.map(d=>d.tag))).sort(); const activeTags=new Set();
    function renderTags(){ tagBar.innerHTML=''; allTags.forEach(t=>{ const chip=document.createElement('span'); chip.className='chip'; chip.textContent=t; if(activeTags.has(t)) chip.classList.add('active'); chip.onclick=()=>{ if(activeTags.has(t)) activeTags.delete(t); else activeTags.add(t); renderList(); renderTags(); }; tagBar.appendChild(chip); }); if(activeTags.size){ const clear=document.createElement('button'); clear.className='btn ghost'; clear.textContent='æ¸…é™¤æ¨™ç±¤'; clear.onclick=()=>{ activeTags.clear(); renderList(); renderTags(); }; tagBar.appendChild(clear); } }
    renderTags();
    const onlyFavBtn=document.getElementById('showFav'); let onlyFav=false; onlyFavBtn.onclick=()=>{ onlyFav=!onlyFav; onlyFavBtn.textContent = onlyFav? 'é¡¯ç¤ºå…¨éƒ¨' : 'åªçœ‹æ”¶è—'; renderList(); };

    const listEl=document.getElementById('dialogueList');
    function saveFavs(){ localStorage.setItem('favs', JSON.stringify(Array.from(favSet))); }
    function toggleFav(key){ if (favSet.has(key)) favSet.delete(key); else favSet.add(key); saveFavs(); renderList(); }
    function renderList(){ const key=(document.getElementById('q').value||'').trim().toLowerCase(); listEl.innerHTML=''; let data=DATA_DIALOGUES.map((d,idx)=>Object.assign({idx}, d)); if (key) data=data.filter(d=> d.tag.toLowerCase().includes(key) || d.ko.join(' ').toLowerCase().includes(key) || d.zh.join(' ').toLowerCase().includes(key)); if (activeTags.size) data=data.filter(d=> activeTags.has(d.tag)); if (onlyFav) data=data.filter(d=> favSet.has(d.idx));
      data.forEach(d=>{ const wrap=document.createElement('div'); wrap.className='box'; const title=document.createElement('div'); title.innerHTML=`<b>${d.idx+1}. ${d.tag}</b>`; wrap.appendChild(title);
        d.ko.forEach((line,i)=>{ const row=document.createElement('div'); row.className='dialogue'; const left=document.createElement('div'); left.innerHTML=`<div class="ko">${i===0?'â“':''} ${line}</div><div class="zh">â€” ${d.zh[i] || ''}</div>`; const right=document.createElement('div'); right.className='right'; const speakBtn=document.createElement('button'); speakBtn.className='btn'; speakBtn.textContent='â–¶ æœ—è®€'; speakBtn.onclick=()=>speak(line); const fav=document.createElement('span'); fav.className='fav'; fav.textContent = favSet.has(d.idx)? 'â¤ï¸' : 'ğŸ¤'; fav.title='æ”¶è—/å–æ¶ˆæ”¶è—'; fav.onclick=()=>toggleFav(d.idx); right.appendChild(speakBtn); right.appendChild(fav); row.appendChild(left); row.appendChild(right); wrap.appendChild(row); }); listEl.appendChild(wrap); }); }
    renderList(); document.getElementById('q').addEventListener('input', renderList);
    function resetFilter(){ document.getElementById('q').value=''; activeTags.clear(); onlyFav=false; document.getElementById('showFav').textContent='åªçœ‹æ”¶è—'; renderList(); renderTags(); } window.resetFilter=resetFilter;

    // è‡ªè¨‚ä¸­æ–‡â†’éŸ“æ–‡
    const cnInput=document.getElementById('cnInput'); const koInput=document.getElementById('koInput');
    document.getElementById('cnSuggest').onclick=()=>{ const txt=(cnInput.value||'').trim(); if(!txt) return; let out=txt; for(const k in DATA_CN2KO){ if(out.includes(k)) out = out.replaceAll(k, DATA_CN2KO[k]); } out = out.replaceAll('è«‹','').replaceAll('å¹«æˆ‘','').trim(); if(!/[ê°€-í£]/.test(out)) out='í•œêµ­ì–´ë¡œ ìˆ˜ì •í•´ ì£¼ì„¸ìš”'; koInput.value=out; };
    document.getElementById('koSpeak').onclick=()=>{ const t=(koInput.value||'').trim(); if(t) speak(t); };
    const myListEl=document.getElementById('myList');
    function renderMy(){ const mine=JSON.parse(localStorage.getItem('myDialogues')||'[]'); myListEl.innerHTML='<h3>æˆ‘çš„å°è©±</h3>'; if(!mine.length) myListEl.innerHTML+='<div class="small">å°šç„¡è‡ªè¨‚å°è©±</div>'; mine.forEach((d,idx)=>{ const row=document.createElement('div'); row.className='dialogue'; const left=document.createElement('div'); left.innerHTML=`<div class="ko">ğŸ—£ï¸ ${d.ko}</div><div class="zh">â€” ${d.cn}</div>`; const right=document.createElement('div'); right.className='right'; const btn=document.createElement('button'); btn.className='btn'; btn.textContent='â–¶ æœ—è®€'; btn.onclick=()=>speak(d.ko); const del=document.createElement('button'); del.className='btn outline'; del.textContent='åˆªé™¤'; del.onclick=()=>{ const arr=JSON.parse(localStorage.getItem('myDialogues')||'[]'); arr.splice(idx,1); localStorage.setItem('myDialogues', JSON.stringify(arr)); renderMy(); }; right.appendChild(btn); right.appendChild(del); row.appendChild(left); row.appendChild(right); myListEl.appendChild(row); }); }
    renderMy();
    document.getElementById('saveCustom').onclick=()=>{ const cn=(cnInput.value||'').trim(); const ko=(koInput.value||'').trim(); if(!cn||!ko) return; const arr=JSON.parse(localStorage.getItem('myDialogues')||'[]'); arr.unshift({cn,ko}); localStorage.setItem('myDialogues', JSON.stringify(arr)); cnInput.value=''; koInput.value=''; renderMy(); };

    // æ¸¬é©—éŠæˆ²
    let quizData=[]; let score=0; let total=0;
    function startQuiz(){ const pool=[]; DATA_DIALOGUES.forEach(d=> d.ko.forEach((k,i)=> pool.push({ko:k, zh:d.zh[i]||''}))); quizData = pool.sort(()=>Math.random()-0.5).slice(0, maxQuestions()); score=0; total=0; renderQuiz(); }
    function maxQuestions(){ return Math.min(20, Math.max(8, Math.floor(DATA_DIALOGUES.length*1.5))); } // è‡ªå‹•ä¾é¡Œåº«å¤§å°èª¿æ•´
    function renderQuiz(){ const area=document.getElementById('quizArea'); const scoreBox=document.getElementById('quizScore'); if (total>=quizData.length){ area.innerHTML='<b>å®Œæˆï¼</b>'; scoreBox.textContent=`å¾—åˆ†ï¼š${score} / ${quizData.length}`; return; } const q=quizData[total]; const allZH=DATA_DIALOGUES.flatMap(d=>d.zh).filter(Boolean); const opts=new Set([q.zh]); while(opts.size<4 and len(allZH)>3) opts.add(allZH[Math.floor(Math.random()*allZH.length)]); const choices=Array.from(opts); while(choices.length<4) choices.push("ï¼ˆç©ºï¼‰"); choices.sort(()=>Math.random()-0.5);
      area.innerHTML=''; const box=document.createElement('div'); box.className='box'; box.innerHTML=`<div class="ko">ğŸ—£ï¸ ${q.ko}</div><div class="small">è«‹é¸å‡ºæ­£ç¢ºä¸­æ–‡æ„æ€</div>`; const row=document.createElement('div'); row.className='row'; choices.forEach(c=>{ const b=document.createElement('button'); b.className='btn ghost'; b.textContent=c; b.onclick=()=>{ if(c===q.zh) score++; total++; renderQuiz(); }; row.appendChild(b); }); const speakBtn=document.createElement('button'); speakBtn.className='btn'; speakBtn.textContent='â–¶ æœ—è®€éŸ“æ–‡'; speakBtn.onclick=()=>speak(q.ko); box.appendChild(document.createElement('br')); box.appendChild(speakBtn); area.appendChild(box); area.appendChild(row); scoreBox.textContent=`ç›®å‰å¾—åˆ†ï¼š${score} / ${total}`; }
    document.getElementById('startQuiz').onclick=startQuiz;

    // PWA
    if ('serviceWorker' in navigator) navigator.serviceWorker.register('./service-worker.js');
  </script>
</body>
</html>
